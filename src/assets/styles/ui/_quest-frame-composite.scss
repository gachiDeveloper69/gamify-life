@use '../base/core' as *;

@keyframes rail-glow {
  0%,
  100% {
    filter: drop-shadow(0 0 1px rgba(4, 239, 249, 0.12));
  }
  50% {
    filter: drop-shadow(0 0 6px rgba(4, 239, 249, 0.28));
  }
}

@keyframes rail-brightness {
  0%,
  100% {
    opacity: 0.72;
    filter: brightness(1);
  }
  50% {
    opacity: 1;
    filter: brightness(1.25);
  }
}

.qframe {
  /* темы/цвета */
  --frame-bg: rgba(3, 45, 70, 1);

  --color-frame-stroke: #025774;
  --color-accent: #04eff9;
  --color-inner: #014359;
  --color-rail: #008eb0;

  /* размеры 9-slice */
  --tile: 24px; /* угол */
  --edge: 8px; /* толщина side/top контейнера*/

  position: relative;
  width: 100%;
  height: 100%;

  display: grid;
  grid-template-columns: var(--tile) 1fr var(--tile);
  grid-template-rows: var(--tile) 1fr var(--tile);
}

.qframe__corner,
.qframe__edge,
.qframe__center {
  position: relative;
}

.qframe__corner {
  z-index: 3;
}
.qframe__edge {
  z-index: 2;
}
.qframe__center {
  z-index: 1;
}

/* Центр занимает середину сетки */
.qframe__center {
  grid-column: 2;
  grid-row: 2;
  position: relative;
  overflow: hidden;
}

/* Фон панели — отдельно, не в SVG */
.qframe__bg {
  position: absolute;
  inset: 0;

  /* База + виньетка */
  background:
    radial-gradient(
      circle at 50% 35%,
      rgba(10, 70, 95, 0.45) 0%,
      rgba(3, 45, 70, 0.6) 52%,
      rgba(2, 22, 35, 0.92) 100%
    ),
    radial-gradient(circle at 12% 20%, rgba(4, 239, 249, 0.06) 0%, rgba(4, 239, 249, 0) 40%),
    radial-gradient(circle at 88% 18%, rgba(4, 239, 249, 0.05) 0%, rgba(4, 239, 249, 0) 45%);

  overflow: hidden;
}

/* dotted layer */
.qframe__bg::before {
  content: '';
  position: absolute;
  inset: 0;

  background-image: radial-gradient(rgba(180, 245, 255, 0.12) 1px, rgba(0, 0, 0, 0) 1px);

  background-size: 16px 16px;
  background-position: 2px 6px;
  opacity: 0.35;

  /* чуть-чуть “вдавить” в фон */
  filter: blur(0.1px);
}

/* noise / grime layer */
.qframe__bg::after {
  content: '';
  position: absolute;
  inset: 0;

  /* SVG turbulence noise data-uri */
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='240' height='240'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='240' height='240' filter='url(%23n)' opacity='.45'/%3E%3C/svg%3E");
  background-size: 280px 280px;
  opacity: 0.1;

  mix-blend-mode: overlay;

  /* лёгкая виньетка сверху/снизу как “грязь” */
  box-shadow:
    inset 0 80px 120px rgba(0, 0, 0, 0.22),
    inset 0 -110px 160px rgba(0, 0, 0, 0.3);
}

/* Контент поверх фона */
.qframe__content {
  position: relative;
  z-index: 1;
  height: 100%;
}

/* Углы — по углам грида, поверх всего */
.qframe__corner {
  width: 100%;
  height: 100%;
  z-index: 3; /* углы крышки */
}

.qframe__corner--tl {
  grid-column: 1;
  grid-row: 1;
}
.qframe__corner--tr {
  grid-column: 3;
  grid-row: 1;
}
.qframe__corner--bl {
  grid-column: 1;
  grid-row: 3;
}
.qframe__corner--br {
  grid-column: 3;
  grid-row: 3;
}

/* Стороны — под углами */
.qframe__edge {
  width: 100%;
  height: 100%;
  z-index: 2;
}

.qframe__edge--top {
  grid-column: 2;
  grid-row: 1;
}
.qframe__edge--bottom {
  grid-column: 2;
  grid-row: 3;
}
.qframe__edge--left {
  grid-column: 1;
  grid-row: 2;
}
.qframe__edge--right {
  grid-column: 3;
  grid-row: 2;
}

/* Поворачиваем side svg-шки если ты экспортил их горизонтальными */
.qframe__edge--left,
.qframe__edge--right {
  /* если left/right экспортированы вертикальными — удали transform */
  /* transform: rotate(90deg); transform-origin: center; */
}

/* ---- Стилизация через id из SVG (Figma) ---- */

/* rail: дыхание + brightness */
.qframe :is(svg) #rail {
  animation: rail-glow 10s ease-in-out infinite;
  will-change: filter;
}

.qframe :is(svg) #rail path,
.qframe :is(svg) path#rail {
  animation: rail-brightness 10s ease-in-out infinite;
  will-change: opacity, filter;
  fill: var(--color-rail);
}

/* внешний контур */
.qframe :is(svg) #frame-stroke,
.qframe :is(svg) path#frame-stroke {
  stroke: var(--color-frame-stroke);
}

/* внутренний контур */
.qframe :is(svg) #inner-stroke,
.qframe :is(svg) path#inner-stroke {
  stroke: var(--color-inner);
}

/* акцент */
.qframe :is(svg) #accent,
.qframe :is(svg) path#accent {
  fill: var(--color-accent);
}

.qframe__edge,
.qframe__corner {
  width: 100%;
  height: 100%;
  display: block;
}
