@use '../base/core' as *;

.briefing {
  --color-difficulty: rgba(4, 239, 249, 0.9);

  display: flex;
  flex-direction: column;
  gap: 14px;
  min-height: 0;
  height: 100%;

  &__header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 32px;
    margin-bottom: 12px;
    flex: 0 0 auto;
  }

  &__difficulty {
    align-self: center;
  }

  &__details {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 10px;
    padding-top: 4px;
  }

  &__line {
    position: relative;
    display: flex;
    align-items: center;
    gap: 8px;
    padding-right: 120px; /* запас под линию */

    &::after {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      top: 50%;
      transform: translateY(-50%);

      height: 1px;
      background: linear-gradient(
        to right,
        var(--color-difficulty),
        color-mix(in srgb, var(--color-difficulty) 40%, transparent),
        transparent
      );

      opacity: 0.75;
      pointer-events: none;
    }
    &--easy {
      --color-difficulty: #{$color-easy};
    }
    &--medium {
      --color-difficulty: #{$color-medium};
    }
    &--hard {
      --color-difficulty: #{$color-hard};
    }
  }

  &__label {
    position: relative;
    z-index: 1;
    padding: 4px 14px;

    font-family: 'Orbitron';
    font-size: 11px;
    letter-spacing: 0.12em;
    text-transform: uppercase;

    color: rgba(10, 20, 24, 0.9);
    background: var(--color-difficulty);

    clip-path: polygon(12% 0%, 88% 0%, 100% 50%, 88% 100%, 12% 100%, 0% 50%);

    box-shadow:
      0 0 10px color-mix(in srgb, var(--color-difficulty) 45%, transparent),
      inset 0 1px 0 rgba(255, 255, 255, 0.35);
  }

  &__mission-title {
    margin: 4px 0 2px;
    font-family: 'Exo-2';
    font-weight: 600;
    font-size: 20px;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2; // ← 2 строки
    overflow: hidden;
    color: rgba(225, 248, 255, 0.96);

    text-shadow: 0 0 10px rgba(4, 239, 249, 0.12);
  }

  &__mission-title--input {
    appearance: none;
    width: 100%;
    border: 0;
    outline: none;
    background: transparent;

    // наследуем “как заголовок”
    margin: 4px 0 2px;
    font-family: 'Exo-2';
    font-weight: 600;
    font-size: 20px;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    color: rgba(225, 248, 255, 0.96);

    text-shadow: 0 0 10px rgba(4, 239, 249, 0.12);

    // чтобы курсор/каретка не смотрелись чужеродно
    caret-color: rgba(4, 239, 249, 0.95);

    // маленький “редакторный HUD”-контур только когда фокус
    border-radius: 10px;
    padding: 6px 10px;
    margin-left: -10px; // компенсируем padding, чтобы визуально не прыгал
    margin-right: -10px;

    transition:
      background 140ms ease,
      box-shadow 140ms ease;

    &::placeholder {
      color: rgba(180, 245, 255, 0.35);
      text-shadow: none;
    }

    &:focus {
      background: linear-gradient(to bottom, rgba(4, 239, 249, 0.08), rgba(0, 0, 0, 0));

      box-shadow:
        inset 0 0 0 1px rgba(4, 239, 249, 0.22),
        0 0 20px rgba(4, 239, 249, 0.06);
    }
  }

  &__meta {
    display: flex;
    align-items: center;
    gap: 0px;
    margin-top: 2px;
  }

  &__body {
    position: relative;
    // padding-inline: 18px;
    border-radius: 14px;
    display: flex;
    flex-direction: column;
    flex: 1 1 auto;
    min-height: 0;
    overflow-y: hidden;

    background:
      radial-gradient(circle at 30% 20%, rgba(4, 239, 249, 0.08), transparent 55%),
      linear-gradient(to bottom, rgba(255, 255, 255, 0.04), rgba(0, 0, 0, 0));

    box-shadow:
      inset 0 0 0 1px rgba(4, 239, 249, 0.12),
      inset 0 1px 0 rgba(255, 255, 255, 0.06),
      0 0 18px rgba(4, 239, 249, 0.05);

    @include scroll-fade-overlay(30);
  }

  &__body--editable {
    transition: box-shadow 160ms ease;

    &:hover {
      box-shadow:
        inset 0 0 0 1px rgba(4, 239, 249, 0.18),
        inset 0 1px 0 rgba(255, 255, 255, 0.06),
        0 0 22px rgba(4, 239, 249, 0.07);
    }

    &:focus-within {
      box-shadow:
        inset 0 0 0 1px rgba(4, 239, 249, 0.28),
        inset 0 1px 0 rgba(255, 255, 255, 0.06),
        0 0 26px rgba(4, 239, 249, 0.09);
    }
  }

  &__scroll {
    height: 100%;
    overflow-y: auto;
    min-height: 0;
    @include custom-scrollbar;
  }

  &__desc {
    padding: 12px 14px;
    position: relative;
    color: rgba(180, 245, 255, 0.62);
    font-family: 'Exo-2';
    font-size: 14px;
    line-height: 1.55;
    white-space: pre-wrap; /* если описание с переносами */

    flex: 1 1 auto;
    min-height: 0;

    // padding-block: 5px;

    &--muted {
      opacity: 0.65;
    }
  }

  &__desc--textarea {
    width: 100%;
    min-height: 100%;
    resize: none;

    border: 0;
    outline: none;
    background: transparent;

    padding: 12px 14px;

    color: rgba(180, 245, 255, 0.72);
    font-family: 'Exo-2';
    font-size: 14px;
    line-height: 1.55;

    // чтоб переносы были как в тексте
    white-space: pre-wrap;

    caret-color: rgba(4, 239, 249, 0.95);

    transition:
      background 140ms ease,
      box-shadow 140ms ease;

    &::placeholder {
      color: rgba(180, 245, 255, 0.35);
    }

    &:focus {
      // легкая подсветка “как терминал”
      background: radial-gradient(circle at 30% 20%, rgba(4, 239, 249, 0.06), transparent 60%);
    }
  }
}

/* Цвета сложности */

.bmeta {
  &__item {
    display: flex;
    // align-items: flex-end;
    justify-content: center;
    // gap: 6px;
    // padding-inline: 5px;
    font-family: 'Exo-2';
    font-size: 14px;
    letter-spacing: 0.08em;

    height: 22px;
    min-width: 120px;
    padding-inline: 10px;

    color: rgba(180, 245, 255, 0.75);

    clip-path: polygon(10% 0, 100% 0, 90% 100%, 0% 100%);
    background: linear-gradient(to bottom, rgba(4, 239, 249, 0.14), rgba(4, 239, 249, 0.06));

    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, 0.08),
      inset 0 0 0 0px rgba(4, 239, 249, 0.16),
      0 0 18px rgba(4, 239, 249, 0.06);
    &--xp {
      align-self: flex-end;
      text-transform: uppercase;
    }

    &:not(:first-child) {
      margin-left: -5px;
    }
  }

  &__icon {
    font-size: 14px;
    color: rgba(4, 239, 249, 0.85);
    filter: drop-shadow(0 0 6px rgba(4, 239, 249, 0.35));
  }

  &__label {
    color: rgba(180, 245, 255, 0.55);
  }

  &__value {
    color: rgba(220, 250, 255, 0.9);
  }
}
